<!DOCTYPE html>
<html lang="pt-br">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title> Chat </title>

    <style>

        body{
            font-family: 'Poppins', sans-serif;
        }

        button{
            padding: 10px 30px;
            background-color: dodgerblue;
            color: white;
            font-size: 16px;
            outline: none;
            border: none;
            border-radius: 20px;
            display: block;
            margin: 10px 0;
        }

    </style>

</head>

<body>

    <div id="content"> Conteúdo a Ser Alterado </div>

    <input type="text" id="name" placeholder="Digite Seu Nome">
    <input type="text" id="mensage">

    <button onclick="gravarViaAjax()"> Enviar Dados </button>

    <script>

		//funcao para buscar dados de maneira assÃ­ncrona
		function buscarViaAjax(){

        var ajax = new XMLHttpRequest();

        ajax.onreadystatechange = function(){

            if( ajax.readyState == 4 ){
                document.getElementById("content").innerHTML = ajax.responseText;
            }

        };

        ajax.open("GET", "lerArquivo.php");
        ajax.send();

        }

        setInterval( buscarViaAjax, 500);

        //funcao para gravar dados de maneira assÃ­ncrona
        function gravarViaAjax(){

        // Conteudo do campo de mensagem eh armazenado na variavel 'texto'
        texto = document.getElementById("mensage").value;
        // Limpa o campo da mensagem
        document.getElementById("mensage").value = "";

        var ajax = new XMLHttpRequest();

        // Concatena o conteudo da variavel 'texto' na chamada GET
        ajax.open("GET", "gravarArquivo.php?msg=" + texto);
        ajax.send();

        }

        var input = document.getElementById("mensage");

        // Evento para verificar se o "ENTER" fora pressionado no elemento HTML
        input.addEventListener("keyup", function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            if( input.value != "" )
                gravarViaAjax();
        }
        });


    </script>

</body>

</html>